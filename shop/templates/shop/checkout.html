{% extends "shop/base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid py-5">
  <h2 class="mb-4 fw-bold text-center text-decoration-underline">ðŸ’³ Checkout</h2>

  {% if items %}
  <div class="row g-4">
    <!-- Checkout Form -->
    <div class="col-lg-6">
      <div class="card shadow-sm border-0 p-4">
        <h4 class="fw-bold mb-3">Billing Details</h4>
        <form method="post" action="{% url 'shop:process_checkout' %}">
          {% csrf_token %}

          <div class="mb-3">
            <label for="full_name" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="full_name" name="full_name" required placeholder="John Doe">
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="email" name="email" required placeholder="example@email.com">
          </div>

          <div class="mb-3">
            <label for="address" class="form-label">Address</label>
            <input type="text" class="form-control" id="address" name="address" required placeholder="123 Main Street">
          </div>

          <div class="mb-3">
            <label for="city" class="form-label">City</label>
            <input type="text" class="form-control" id="city" name="city" required>
          </div>

          <div class="mb-3">
            <label for="zip" class="form-label">Eircode</label>
            <input type="text" class="form-control" id="zip" name="zip" required>
          </div>

          <div class="mb-4">
            <label for="payment_method" class="form-label">Payment Method</label>
            <select id="payment_method" name="payment_method" class="form-select" required>
              <option value="">Select...</option>
              <option value="card">Credit/Debit Card</option>
              <option value="Visa">Visa</option>
              <option value="mastercard">MasterCard</option>
              <option value="paypal">PayPal</option>
            </select>
          </div>

          <button type="submit" class="btn btn-success w-100">
            <i class="bi bi-check-circle"></i> Place Order
          </button>
        </form>
      </div>
    </div>

    <!-- Order Summary -->
    <div class="col-lg-6">
      <div class="card shadow-sm border-0 p-4">
        <h4 class="fw-bold mb-3">Your Order</h4>
        <ul class="list-group list-group-flush">
          {% for item in items %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
              {% if item.product.image %}
              <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                   class="img-thumbnail me-3" style="width: 70px; height: 70px; object-fit: cover; border-radius: 10px;">
              {% else %}
              <img src="{% static 'shop/images/no_image.png' %}" alt="No image"
                   class="img-thumbnail me-3" style="width: 70px; height: 70px; object-fit: cover; border-radius: 10px;">
              {% endif %}
              <div>
                <p class="mb-0 fw-semibold">{{ item.product.name }}</p>
                <small class="text-muted">x{{ item.quantity }}</small>
              </div>
            </div>
            <span class="fw-semibold">â‚¬{{ item.subtotal|floatformat:2 }}</span>
          </li>
          {% endfor %}
        </ul>

        <div class="border-top mt-3 pt-3 text-end">
          <h5>Total: <span class="text-success fw-bold">â‚¬{{ total|floatformat:2 }}</span></h5>
        </div>
      </div>
    </div>
  </div>

  {% else %}
  <div class="text-center py-5">
    <p class="fs-5 text-muted">Your cart is empty.</p>
    <a href="{% url 'shop:main' %}" class="btn btn-primary mt-3">Continue Shopping</a>
  </div>
  {% endif %}
</div>
{% endblock %}
